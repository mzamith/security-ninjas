<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Unvalidated Redirects or Forwards</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a class="logo"><strong>10.</strong> Unvalidated Redirects and Forwards</a>
									<ul class="icons">
										<li><a href="https://github.com/mzamith/security-ninjas" class="icon fa-github"><span class="label">Github</span></a></li>
									</ul>
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Unvalidated Redirects and Forwards</h1>
									</header>

									<span class="image main"><img src="images/10-big.png" alt="" /></span>

									<p>This flaw occurs when a malicious attacker is able to redirect a user to an untrusted website when a trusted website link is visited.</p>
									<p>It's also called, often, Open Redirect.</p>

									<h4>Example</h4>
									<p>Assuming there's a router file somewhere in the system that handles redirects and forwards.</p>
									<p>A normal request would look like this: <code>https://example.com/router.php?url=example.php</code></p>
									<p>The code to read this would look the following:
<pre><code>&lt;?php
header("Location: ".$_GET["url"]);
die();
?&gt;
</code></pre>
									</p>
									<p>However, as there are no checks to what the parameter could be, a malicious attacker would be able to conduct something like the following example:</p>
									<code>
										https://example.com/router.php?url=https://phishing.example
									</code>

									<hr class="major" />

									<h2>Is my application vulnerable to this flaw?</h2>
									<p>According to OWASP, the best way to validate if the application is vulnerable to this type of flaw is to:</p>
									<ul>
										<li>Review the code for all usage of redirects and/or forwards. For each validate the input parameter against a whitelist.</li>
										<li>Spider the site to see if HTTP 300-307, usually 302 code (redirect/forward codes), is generated. For each, change the target and observe the behaviour.</li>
										<li>If you don't have code access, check all the input parameters to see if they look like part of a redirect or forward URL destination.</li>
									</ul>

									<hr class="major" />

									<h2>Security Ninjas Resolution</h2>
									<p>.</p>

									<hr class="major" />

									<h2>How to prevent it</h2>
									<p>This might look nonsense but the best way to get rid of this flaw is to avoid the usage of redirects and forwards.
										Though, if it's imperative to use them, try not to involve user parameters in the destination calculation.
										In case that this parameters can't be left apart make sure the supplied value is valid and authorized for the user.
									</p>
									<p>Avoiding this kind of flaws is extremely important since they're phisers favorite attack to get user's trust.</p>

								</section>

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Homepage</a></li>
										<li><a href="setup.html">Set up</a></li>
										<li>
											<span class="opener">Game On!</span>
											<ul>
												<li><a href="1.html">Injection</a></li>
												<li><a href="2.html">Broken Authentication and Session Management</a></li>
												<li><a href="3.html">Cross-Site Scripting (XSS)</a></li>
												<li><a href="4.html">Insecure Direct Object References</a></li>
												<li><a href="5.html">Security Misconfiguration</a></li>
												<li><a href="6.html">Sensitive Data Exposure</a></li>
												<li><a href="7.html">Missing Function Level Access Control</a></li>
												<li><a href="8.html">Cross-Site Request Forgery (CSRF)</a></li>
												<li><a href="9.html">Using Components with Known Vulnerabilities</a></li>
												<li><a href="10.html">Unvalidated Redirects and Forwards</a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->

								<section>
									<div class="mini-posts">
										<article>
											<a class="image"><img src="images/feup.jpg" alt="" /></a>
										</article>
								</section>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Find us on Github!</h2>
									</header>
									<p>We're two Sourcerer wannabees with a serious passion for Software Engineering. We hope to have helped you in any way.</p>
									<ul class="contact">
										<li class="fa-github"><a href="https://github.com/mzamith">Manuel Zamith</a></li>
										<li class="fa-github"><a href="https://github.com/ngmatos">Nuno Matos</a></li>
									</ul>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">Made with <span class="icon fa-heartbeat" style="color: red"></span>  @FEUP.</p>
								</footer>

						</div>					
					</div>
			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>