<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>CSRF</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/styles.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a class="logo"><strong>8.</strong> Cross Site Request Forgery Attacks (CSRF)</a>
									<ul class="icons">
										<li><a href="https://github.com/mzamith/security-ninjas" class="icon fa-github"><span class="label">Github</span></a></li>
									</ul>
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Cross Site Request Forgery Attacks (CSRF)</h1>
									</header>

									<span class="image main"><img src="images/8-big.png" alt="" /></span>

									<p>Also known as CSRF, this is an attack that forces a currently authenticated user to perform unwanted actions in the system, without his knowledge.</p>
									<p>While in <a href="3.html">XSS</a> the attacker exploits the trust a user has for a website, with CSRF on the other hand, the attacker exploits the trust a website has against a user's browser.</p>
									<p>This works by tricking a victim into accessing a website or clicking an URL link that contains malicious or unauthorized requests.</p>
									<h4>Bank transaction example</h4>
									<h5>Wrapped in HREF</h5>
									<code>
										&lt;a href&#61;http://example.bank/transfer.aspx?acct=MALICIOUS&amp;amount&#61;AMOUNT&gt;Click to watch video!&lt;/a&gt;
									</code>
									<p></p>
									<h5>Wrapped in Image</h5>
									<code>
										&lt;img src&#61;http://example.bank/transfer.aspx?acct=MALICIOUS&amp;amount&#61;AMOUNT&gt;										
									</code>

									<hr class="major" />

									<h2>Is my application vulnerable to this flaw?</h2>
									<p>Some guidelines to check if your application is vulnerable or not is, for starters, to check if any link and/or form lack an unpredictable CSRF token. Without it malicious requests can be forged easily.
										Another one is to implement a functionality where the user has to confirm he wants to do such action, either through reauthentication, CAPTCHA and others.
									</p>

									<hr class="major" />

									<h2>Security ninjas resolution</h2>
									<img src="gifs/csrf.gif" alt="">

									<hr class="major" />

									<h2>How to prevent it</h2>
									<p>Preventing such flaw usually requires that each HTTP request includes a unique per session, at minimum, and unpredictable token.</p>
									<p>The most preferred option is to send it in a hidden field, thus causing it to be sent in the body of the request, avoiding URL exposeness.
										You can use <a href="http://www.owasp.org/index.php/CSRFGuard" target="_blank">OWASP's CSRF Guard</a> that automatically include such tokens in Java, .Net or PHP. Also <a href="http://www.owasp.org/index.php/ESAPI" target="_blank">OWASP's ESAPI</a>
										includes methods that developers can use to prevent CSRF.
									</p>
									<p>As stated earlier, requiring the user to reauthenticate, or prove they really want to do a certain action (e.g. CAPTCHA) can also help to protect against CSRF.</p>

								</section>

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">


							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Homepage</a></li>
										<li><a href="setup.html">Set up</a></li>
										<li>
											<span class="opener">Game On!</span>
											<ul>
												<li><a href="1.html">Injection</a></li>
												<li><a href="2.html">Broken Authentication and Session Management</a></li>
												<li><a href="3.html">Cross-Site Scripting (XSS)</a></li>
												<li><a href="4.html">Insecure Direct Object References</a></li>
												<li><a href="5.html">Security Misconfiguration</a></li>
												<li><a href="6.html">Sensitive Data Exposure</a></li>
												<li><a href="7.html">Missing Function Level Access Control</a></li>
												<li><a href="8.html">Cross-Site Request Forgery (CSRF)</a></li>
												<li><a href="9.html">Using Components with Known Vulnerabilities</a></li>
												<li><a href="10.html">Unvalidated Redirects and Forwards</a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->

								<section>
									<div class="mini-posts">
										<article>
											<a class="image"><img src="images/feup.jpg" alt="" /></a>
										</article>
								</section>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Find us on Github!</h2>
									</header>
									<p>We're two Sourcerer wannabees with a serious passion for Software Engineering. We hope to have helped you in any way.</p>
									<ul class="contact">
										<li class="fa-github"><a href="https://github.com/mzamith">Manuel Zamith</a></li>
										<li class="fa-github"><a href="https://github.com/ngmatos">Nuno Matos</a></li>
									</ul>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">Made with <span class="icon fa-heartbeat" style="color: red"></span>  @FEUP.</p>
								</footer>

						</div>					
					</div>
			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>